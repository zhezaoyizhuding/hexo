---
title: Java基础之线程
date: 2017-03-16 09:58:21
categories: Java
tags:
- Java
- 线程
---

### 一 概述

所谓的多线程就是一个程序中存在多个顺序执行流，每个执行流便是一个线程。Java提供了优秀的多线程支持，下面将会详细介绍Java多线程编程的相关知识。

### 二 线程与进程的比较

现在的操作系统基本都支持多进程，即可以同时运行多个任务，每个任务通常是一个程序，每个运行的程序便是一个进程。而一个程序运行时往往有多个顺序执行流，这每个顺序执行流便是一个线程。

线程与进程的区别：

- 线程比进程更轻，并发性更高
- 线程可以共享进程的资源，便于实现相互之间的通信
- 创建线程的代价比创建进程的代价小得多
- java内置了多线程编程支持，可以非常方便的操作线程

### 三 创建线程的三种方式

##### 1.继承Thread类创建线程

使用Thread类创建线程的步骤如下：

1. 定义Thread的子类并重写它的run方法，run方法的方法体里面就是线程需要完成的任务
2. 创建Thread子类的实例，即创建了线程对象
3. 调用线程对象的start()方法来启动线程

代码示例：

抽空写

##### 2.实现Runnable接口创建线程

步骤如下：

1. 实现接口Runnable接口，并实现它的run方法。
2. 创建Runnable接口实现类的实例，并把它作为参数传给Thread的构造函数，创建Thread对象（即将该实例作为Thread类的Target），并调用它的start方法启动线程。（Runnable接口时函数式接口，可使用Lambda表达式）

代码示例：

- 使用Runnable创建线程的一个优势是多个线程之间可以共享线程类中的实例变量。这也是最常用的一种创建线程的方式，但一般都采用匿名内部类的方式简写。

##### 3. 使用Callable和Future创建线程

从java5开始，java提供了一个Callable接口，接口中提供了一个call()方法来替代run()方法，它比run方法的功能更强大。主要有以下两点：

- call方法可以有返回值
- call方法可以声明抛出异常

由于Callable接口没有继承Runnable接口，且call方法有返回值，因此实现Callable接口的类无法作为Target传入Thread类中。为此java5提供了Future接口来包装Callable接口创建线程，该接口有一个FutureTask实现类，该类同时也实现了Runnable接口，因此该类的对象可以作为Target传入Thread类中来创建线程。

创建并启动有返回值的线程的步骤如下：

1. 创建Callable接口的实现类，并实现它的call方法。、
2. 创建FutureTask类来包装Callable接口的实现类的对象（Callable是函数式接口，这一步可以是Lambda表达式）
3. 将FutureTask对象作为Target传入Thread类中，创建线程。
4. 使用FutureTask对象的get方法得到call的返回值

Callab接口实现线程与Runnable接口类似，因此它也有Runnable接口的优势。

##### 4. 创建线程的三种方式对比

使用Runnable和Callable接口创建线程的优势：

- 因为是实现接口，还可以继承其他类，避免由于Java的单继承特性而带来的局限。
- 这种方式下，多个线程可以共享同一个target对象，所以非常适合多个相同线程来处理同一份资源的情况，从而将CPU，代码和数据分开，更清晰。

劣势：

- 编程稍稍复杂，且要访问当前线程，需要使用Thread.currentThread()方法获取当前线程的实例

使用继承Thread类的方式优势：

- 编程简单

劣势：

因为已经继承了Thread类，无法再继承其他的类。

### 三 线程的声明周期

